import React from 'react';
import { TitleBar } from '@/components/Vulnerabilities/DOM Clobbering/DetailedVulnerability/TitleBar';
import { CodeBlock } from '@/components/Vulnerabilities/DOM Clobbering/DetailedVulnerability/CodeBlocks';
import { PastePanel } from '@/components/Vulnerabilities/DOM Clobbering/DetailedVulnerability/PastePanel';
import { TipGreyBox } from '@/components/Vulnerabilities/DOM Clobbering/DetailedVulnerability/TipGreyBox';
import { NavigationButtons } from '@/components/Vulnerabilities/DOM Clobbering/DetailedVulnerability/NavigationButton';

const DetailedVulnerability = () => {
  React.useEffect(() => {
    document.title = 'Detailed DOM Clobbering';
  }, []);

  return (
    <div className="min-h-screen bg-page pt-14">
      <div className="w-full max-w-[1440px] mx-auto relative">
        <div className="px-10 max-md:px-5">
          <div className="flex flex-col overflow-hidden items-stretch pt-[30px]">
            <header className="self-center flex w-[806px] max-w-full flex-col items-stretch text-[64px] font-normal justify-center px-[15px] py-[29px] max-md:text-[40px] max-md:pr-5 bg-gradient-header rounded-panel shadow-fig-2 text-primary-foreground">
              <h1 className="max-md:max-w-full max-md:text-[40px]">
                üß™ Detailed DOM Clobbering
                <br />
              </h1>
            </header>

            <div className="flex w-full flex-col mt-[15px] pl-8 pr-3.5 max-md:max-w-full max-md:pl-5 bg-instruction rounded-panel p-6">
              <section className="self-center w-full max-w-[1149px] mt-[19px] max-md:max-w-full">
                <div className="gap-5 flex max-md:flex-col max-md:items-stretch">
                  <article className="w-6/12 max-md:w-full max-md:ml-0">
                    <TitleBar className="mb-2">‚ùå Problem Code ‚Äì DOM Clobbering Happens</TitleBar>
                    <CodeBlock className="grow pt-[13px] pb-[21px] px-14 max-md:max-w-full max-md:mt-2 max-md:px-5">
                      {'<!DOCTYPE '}<span className="text-code-keyword">html</span>{'>\n'}
                      {'<html>\n'}{'<head>\n'}{' <title>DOM Clobbering Example</title>\n'}{'</head>\n'}{'<body>\n\n'}{' '}
                      <span className="text-code-comment">{'<!-- A form element with name="submit" -->'}</span>{'\n <form '}
                      <span className="text-code-attr">name</span>{'="'}<span className="text-code-string">submit</span>{'">\n  <input '}
                      <span className="text-code-attr">type</span>{'="'}<span className="text-code-string">text</span>{'" '}
                      <span className="text-code-attr">placeholder</span>{'="'}<span className="text-code-string">Enter something</span>{'">\n  <input '}
                      <span className="text-code-attr">type</span>{'="'}<span className="text-code-string">submit</span>{'" '}
                      <span className="text-code-attr">value</span>{'="'}<span className="text-code-string">Submit</span>{'">\n </form>\n\n <script>\n  '}
                      <span className="text-code-comment">{'// You define a function to handle the form submission'}</span>{'\n  '}
                      <span className="text-code-keyword">function</span>{' '}<span className="text-code-attr">submit</span>{'() {\n    '}
                      <span className="text-code-attr">alert</span>{'("'}<span className="text-code-string">Form submitted successfully!</span>{'");\n  }\n\n  '}
                      <span className="text-code-comment">{'// You try to call the function'}</span>{'\n  '}<span className="text-code-attr">submit</span>{'(); '}
                      <span className="text-code-comment">{"// ‚ùå Doesn't work as expected!"}</span>{'\n </script>\n\n</body>\n</html>'}
                    </CodeBlock>
                  </article>
                  <article className="w-6/12 ml-5 max-md:w-full max-md:ml-0">
                    <TitleBar className="mb-2">‚úÖ Fixed Version ‚Äì Safe from DOM Clobbering</TitleBar>
                    <CodeBlock className="flex grow flex-col items-stretch justify-center px-[38px] py-[15px] max-md:max-w-full max-md:mt-2 max-md:pl-5">
                      {'<!DOCTYPE '}<span className="text-code-keyword">html</span>{'>\n'}
                      {'<html>\n'}{'<head>\n'}{' <title>Fixed DOM Clobbering Example</title>\n'}{'</head>\n'}{'<body>\n\n'}{' '}
                      <span className="text-code-comment">{"<!-- Give the form a name that won't conflict -->"}</span>{'\n <form '}
                      <span className="text-code-attr">name</span>{'="'}<span className="text-code-string">userForm</span>{'">\n  <input '}
                      <span className="text-code-attr">type</span>{'="'}<span className="text-code-string">text</span>{'" '}
                      <span className="text-code-attr">placeholder</span>{'="'}<span className="text-code-string">Enter something</span>{'">\n  <input '}
                      <span className="text-code-attr">type</span>{'="'}<span className="text-code-string">submit</span>{'" '}
                      <span className="text-code-attr">value</span>{'="'}<span className="text-code-string">Submit</span>{'">\n </form>\n\n <script>\n  '}
                      <span className="text-code-comment">{"// Use 'let' to define the function in block scope (never as global)"}</span>{'\n  '}
                      <span className="text-code-keyword">let</span>{' submit = '}<span className="text-code-keyword">function</span>{' () {\n    '}
                      <span className="text-code-attr">alert</span>{'("'}<span className="text-code-string">Form submitted safely!</span>{'");\n  };\n\n  '}
                      <span className="text-code-comment">{'// Now this safely calls your function'}</span>{'\n  '}<span className="text-code-attr">submit</span>{'(); '}
                      <span className="text-code-comment">{'// ‚úÖ Works fine!'}</span>{'\n </script>\n\n</body>\n</html>'}
                    </CodeBlock>
                  </article>
                </div>
              </section>

              <section className="self-center w-full max-w-[1249px] max-md:max-w-full">
                <div className="gap-5 flex max-md:flex-col max-md:items-stretch">
                  <article className="w-6/12 max-md:w-full max-md:ml-0">
                    <PastePanel title={<span>‚ö†Ô∏è What Went Wrong?</span>} className="grow">
                      <div className="max-md:max-w-full">
                        The form's name="submit" makes the browser <br />
                        treat submit as a global variable pointing to the form element.
                        <br />
                        Now, submit() is no longer your function ‚Äî it's the form!
                        <br />
                        The browser gets confused, and your function doesn't run.
                      </div>
                    </PastePanel>
                  </article>
                  <article className="w-6/12 ml-5 max-md:w-full max-md:ml-0">
                    <PastePanel title={<span>‚úÖ Best Practices in This Fix:</span>} className="grow">
                      <div className="max-md:max-w-full">
                        Avoid name="submit" or id="submit" in HTML ‚Äî use something unique.
                        <br />
                        Use let, const, or var instead of creating global functions or variables.
                        <br />
                        Avoid naming elements after common JavaScript methods like submit, <br />
                        reset, login, etc.
                      </div>
                    </PastePanel>
                  </article>
                </div>
              </section>

              <section className="w-full max-w-screen-xl mt-[5px] max-md:max-w-full">
                <div className="gap-5 flex max-md:flex-col max-md:items-stretch">
                  <article className="w-3/5 max-md:w-full max-md:ml-0">
                    <TipGreyBox title={<span>üß† Extra Tip: Debugging DOM Clobbering</span>}>
                      <div>
                        Open your browser console (right-click ‚Üí Inspect ‚Üí Console), then type:
                      </div>
                      <CodeBlock className="mt-2 px-[69px] py-1 max-md:max-w-full max-md:px-5">
                        <div>
                          <span className="text-code-attr">console</span>
                          {'.'}
                          <span className="text-code-attr">log</span>
                          {'('}
                          <span className="text-code-keyword">typeof</span>
                          {' submit);'}
                        </div>
                      </CodeBlock>
                      <div className="mt-[7px] max-md:max-w-full">
                        If it returns 'function' ‚Üí you're safe.
                        <br />
                        If it returns 'object' or 'HTMLFormElement' ‚Üí you're clobbered!
                      </div>
                    </TipGreyBox>
                  </article>
                  <aside className="w-2/5 ml-5 max-md:w-full max-md:ml-0">
                    <NavigationButtons />
                  </aside>
                </div>
              </section>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

export default DetailedVulnerability;
